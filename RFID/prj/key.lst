C51 COMPILER V9.52.0.0   KEY                                                               10/13/2016 08:51:50 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\key.obj
COMPILER INVOKED BY: G:\Keil for C51\C51\BIN\C51.EXE ..\code\key.c LARGE BROWSE DEBUG OBJECTEXTEND PRINT(.\key.lst) TABS
                    -(2) OBJECT(.\key.obj)

line level    source

   1          #include "reg52.h"
   2          #include "timer.h"
   3          
   4          #define uchar unsigned char 
   5          #define uint unsigned int
   6          
   7          uchar num,temp;   
   8          
   9          uchar key_scan(void) //键盘扫描
  10          {
  11   1        num=16;//16表示没按键输入
  12   1        P1=0xfe; //扫描第一行
  13   1        temp=P1;
  14   1        temp&=0xf0;
  15   1        if(temp!=0xf0)  //检测有按键按下
  16   1        {
  17   2          Delay_ms(5);
  18   2          temp=P1;
  19   2          temp&=0xf0;
  20   2          if(temp!=0xf0)
  21   2          {
  22   3            temp=P1;
  23   3            switch(temp)    //判断按下是哪一个按键
  24   3            {
  25   4              case 0xee:num=1;
  26   4                break;
  27   4              case 0xde:num=2;
  28   4                break;
  29   4              case 0xbe:num=3;
  30   4                break;
  31   4              case 0x7e:num=12;
  32   4                break;
  33   4            }
  34   3            while(temp!=0xf0)
  35   3            {
  36   4              temp=P1;
  37   4              temp&=0xf0; 
  38   4            }
  39   3          }
  40   2        }
  41   1      
  42   1        P1=0xfd;  //扫描第二行
  43   1        temp=P1;
  44   1        temp&=0xf0;
  45   1        if(temp!=0xf0)
  46   1        {
  47   2          Delay_ms(5);
  48   2          temp=P1;
  49   2          temp&=0xf0;
  50   2          if(temp!=0xf0)
  51   2          {
  52   3            temp=P1;
  53   3            switch(temp)
  54   3            {
C51 COMPILER V9.52.0.0   KEY                                                               10/13/2016 08:51:50 PAGE 2   

  55   4              case 0xed:num=4;
  56   4                break;
  57   4              case 0xdd:num=5;
  58   4                break;
  59   4              case 0xbd:num=6;
  60   4                break;
  61   4              case 0x7d:num=13;
  62   4                break;
  63   4            }
  64   3            while(temp!=0xf0)
  65   3            {
  66   4              temp=P1;
  67   4              temp&=0xf0; 
  68   4            } 
  69   3          }
  70   2        }
  71   1      
  72   1        P1=0xfb;         //扫描第三行
  73   1        temp=P1;
  74   1        temp&=0xf0;
  75   1        if(temp!=0xf0)
  76   1        {
  77   2          Delay_ms(5);
  78   2          temp=P1;
  79   2          temp&=0xf0;
  80   2          if(temp!=0xf0)
  81   2          {
  82   3            temp=P1;
  83   3            switch(temp)
  84   3            {
  85   4              case 0xeb:num=7;
  86   4                break;
  87   4              case 0xdb:num=8;
  88   4                break;
  89   4              case 0xbb:num=9;
  90   4                break;   
  91   4              case 0x7b:num=14;
  92   4                break;
  93   4            }
  94   3            while(temp!=0xf0)
  95   3            {
  96   4              temp=P1;
  97   4              temp&=0xf0; 
  98   4            } 
  99   3          }
 100   2        }
 101   1      
 102   1        P1=0xf7;    //扫描第四行
 103   1        temp=P1;
 104   1        temp&=0xf0;
 105   1        if(temp!=0xf0)
 106   1        {
 107   2          Delay_ms(5);
 108   2          temp=P1;
 109   2          temp&=0xf0;
 110   2          if(temp!=0xf0)
 111   2          {
 112   3            temp=P1;
 113   3            switch(temp)
 114   3            {
 115   4              case 0xe7:num=0;
 116   4                break;
C51 COMPILER V9.52.0.0   KEY                                                               10/13/2016 08:51:50 PAGE 3   

 117   4              case 0xd7:num=10;
 118   4                break;
 119   4              case 0xb7:num=11;
 120   4                break;
 121   4              case 0x77:num=15;
 122   4                break;
 123   4            }
 124   3            while(temp!=0xf0)
 125   3            {
 126   4              temp=P1;
 127   4              temp&=0xf0; 
 128   4            } 
 129   3          }
 130   2        }
 131   1        return num;    //返回按键对应编号
 132   1      }   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    431    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      2    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
